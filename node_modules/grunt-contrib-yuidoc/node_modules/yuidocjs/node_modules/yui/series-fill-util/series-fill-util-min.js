/* YUI 3.9.0pr1 (build 202) Copyright 2013 Yahoo! Inc. http://yuilibrary.com/license/ */
YUI.add("series-fill-util",function(e,t){function r(t){var n={area:{getter:function(){return this._defaults||this._getAreaDefaults()},setter:function(t){var n=this._defaults||this._getAreaDefaults();this._defaults=e.merge(n,t)}}};this.addAttrs(n,t),this.get("styles")}var n=e.Lang;r.prototype={_getPath:function(){var e=this._path;return e||(e=this.get("graphic").addShape({type:"path"}),this._path=e),e},_toggleVisible:function(e){this._path&&this._path.set("visible",e)},drawFill:function(e,t){if(e.length<1)return;var r=n.isNumber,i=e.length,s=e[0],o=t[0],u=s,a=o,f,l,c,h=!0,p=0,d=this.get("styles").area,v=this._getPath(),m=d.color||this._getDefaultColor(this.get("graphOrder"),"slice");v.clear(),v.set("fill",{color:m,opacity:d.alpha}),v.set("stroke",{weight:0});for(;p<i;p=++p){f=e[p],l=t[p],c=r(f)&&r(l);if(!c)continue;h?(this._firstValidX=f,this._firstValidY=l,h=!1,v.moveTo(f,l)):v.lineTo(f,l),u=f,a=l}this._lastValidX=u,this._lastValidY=a,v.end()},drawAreaSpline:function(){if(this.get("xcoords").length<1)return;var e=this.get("xcoords"),t=this.get("ycoords"),n=this.getCurveControlPoints(e,t),r=n.length,i,s,o,u,a,f,l=0,c=e[0],h=t[0],p=this.get("styles").area,d=this._getPath(),v=p.color||this._getDefaultColor(this.get("graphOrder"),"slice");d.set("fill",{color:v,opacity:p.alpha}),d.set("stroke",{weight:0}),d.moveTo(c,h);for(;l<r;l=++l)a=n[l].endx,f=n[l].endy,i=n[l].ctrlx1,s=n[l].ctrlx2,o=n[l].ctrly1,u=n[l].ctrly2,d.curveTo(i,o,s,u,a,f);this.get("direction")==="vertical"?(d.lineTo(this._leftOrigin,f),d.lineTo(this._leftOrigin,h)):(d.lineTo(a,this._bottomOrigin),d.lineTo(c,this._bottomOrigin)),d.lineTo(c,h),d.end()},drawStackedAreaSpline:function(){if(this.get("xcoords").length<1)return;var e=this.get("xcoords"),t=this.get("ycoords"),n,r=this.get("order"),i=this.get("type"),s=this.get("seriesTypeCollection"),o,u,a,f,l,c,h,p,d,v=0,m,g,y=this.get("styles").area,b=this._getPath(),w=y.color||this._getDefaultColor(this.get("graphOrder"),"slice");m=e[0],g=t[0],n=this.getCurveControlPoints(e,t),a=n.length,b.set("fill",{color:w,opacity:y.alpha}),b.set("stroke",{weight:0}),b.moveTo(m,g);for(;v<a;v=++v)p=n[v].endx,d=n[v].endy,f=n[v].ctrlx1,l=n[v].ctrlx2,c=n[v].ctrly1,h=n[v].ctrly2,b.curveTo(f,c,l,h,p,d);if(r>0){o=s[r-1].get("xcoords").concat().reverse(),u=s[r-1].get("ycoords").concat().reverse(),n=this.getCurveControlPoints(o,u),v=0,a=n.length,b.lineTo(o[0],u[0]);for(;v<a;v=++v)p=n[v].endx,d=n[v].endy,f=n[v].ctrlx1,l=n[v].ctrlx2,c=n[v].ctrly1,h=n[v].ctrly2,b.curveTo(f,c,l,h,p,d)}else this.get("direction")==="vertical"?(b.lineTo(this._leftOrigin,t[t.length-1]),b.lineTo(this._leftOrigin,g)):(b.lineTo(e[e.length-1],this._bottomOrigin),b.lineTo(m,this._bottomOrigin));b.lineTo(m,g),b.end()},_defaults:null,_getClosingPoints:function(){var e=this.get("xcoords").concat(),t=this.get("ycoords").concat(),n,r;return this.get("direction")==="vertical"?(r=this._getLastValidIndex(e),n=this._getFirstValidIndex(e),t.push(t[r]),t.push(t[n]),e.push(this._leftOrigin),e.push(this._leftOrigin)):(r=this._getLastValidIndex(t),n=this._getFirstValidIndex(t),e.push(e[r]),e.push(e[n]),t.push(this._bottomOrigin),t.push(this._bottomOrigin)),e.push(e[0]),t.push(t[0]),[e,t]},_getHighestValidOrder:function(e,t,n,r){var i=r=="vertical"?"stackedXCoords":"stackedYCoords",s;while(isNaN(s)&&n>-1)n-=1,n>-1&&(s=e[n].get(i)[t]);return n},_getCoordsByOrderAndIndex:function(e,t,n,r){var i,s;return r=="vertical"?(i=n<0?this._leftOrigin:e[n].get("stackedXCoords")[t],s=this.get("stackedYCoords")[t]):(i=this.get("stackedXCoords")[t],s=n<0?this._bottomOrigin:e[n].get("stackedYCoords")[t]),[i,s]},_getStackedClosingPoints:function(){var e=this.get("order"),t=this.get("type"),n=this.get("direction"),r=this.get("seriesTypeCollection"),i,s,o=this.get("stackedXCoords"),u=this.get("stackedYCoords"),a,f,l,c,h,p,d,v,m,g,y,b;if(e<1)return this._getClosingPoints();f=r[e-1],h=f.get("stackedXCoords").concat(),p=f.get("stackedYCoords").concat(),n=="vertical"?(i=this._getFirstValidIndex(o),s=this._getLastValidIndex(o),l=f._getFirstValidIndex(h),c=f._getLastValidIndex(h)):(i=this._getFirstValidIndex(u),s=this._getLastValidIndex(u),l=f._getFirstValidIndex(p),c=f._getLastValidIndex(p)),c>=i&&l<=s?(l=Math.max(i,l),c=Math.min(s,c),h=h.slice(l,c+1),p=p.slice(l,c+1),a=l):a=s,v=[o[i]],m=[u[i]],g=i;while((isNaN(y)||y<e-1)&&g<=a)b=y,y=this._getHighestValidOrder(r,g,e,n),!isNaN(b)&&y>b&&(d=this._getCoordsByOrderAndIndex(r,g,b,n),v.push(d[0]),m.push(d[1])),d=this._getCoordsByOrderAndIndex(r,g,y,n),v.push(d[0]),m.push(d[1]),g+=1;h&&h.length>0&&c>i&&l<s&&(v=v.concat(h),m=m.concat(p),y=e-1),g=Math.max(i,c),e-=1,y=NaN;while(g<=s)b=y,y=this._getHighestValidOrder(r,g,e,n),isNaN(b)||(y>b?(d=this._getCoordsByOrderAndIndex(r,g,b,n),v.push(d[0]),m.push(d[1])):y<b&&(d=this._getCoordsByOrderAndIndex(r,g-1,y,n),v.push(d[0]),m.push(d[1]))),d=this._getCoordsByOrderAndIndex(r,g,y,n),v.push(d[0]),m.push(d[1]),g+=1;return v.reverse(),m.reverse(),[o.concat(v),u.concat(m)]},_getAreaDefaults:function(){return{}}},e.augment(r,e.Attribute),e.Fills=r},"3.9.0pr1",{requires:["series-base"]});
