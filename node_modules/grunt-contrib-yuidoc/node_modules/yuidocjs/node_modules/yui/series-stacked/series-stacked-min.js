/* YUI 3.9.0pr1 (build 202) Copyright 2013 Yahoo! Inc. http://yuilibrary.com/license/ */
YUI.add("series-stacked",function(e,t){function r(){}var n=e.Lang;r.prototype={_stacked:!0,_stackCoordinates:function(){this.get("direction")=="vertical"?this._stackXCoords():this._stackYCoords()},_stackXCoords:function(){var e=this.get("order"),t=this.get("type"),r=this.get("seriesTypeCollection"),i=0,s=this.get("xcoords"),o=this.get("ycoords"),u,a,f,l,c=s.concat(),h,p,d=[],v;e>0?(h=r[e-1].get("stackedXCoords"),p=r[e-1].get("stackedYCoords"),u=h.length):u=s.length;for(;i<u;i+=1)if(n.isNumber(s[i])){if(e>0){f=h[i];if(!n.isNumber(f)){l=e;while(l>-1&&!n.isNumber(f))l-=1,l>-1?f=r[l].get("stackedXCoords")[i]:f=this._leftOrigin}s[i]=s[i]+f}c[i]=s[i]}else d.push(i);this._cleanXNaN(c,o),u=d.length;if(u>0)for(i=0;i<u;i+=1)v=d[i],a=e>0?h[v]:this._leftOrigin,c[v]=Math.max(c[v],a);this.set("stackedXCoords",c),this.set("stackedYCoords",o)},_stackYCoords:function(){var e=this.get("order"),t=this.get("type"),r=this.get("graphic"),i=r.get("height"),s=this.get("seriesTypeCollection"),o=0,u=this.get("xcoords"),a=this.get("ycoords"),f,l,c,h,p=a.concat(),d,v,m=[],g;e>0?(d=s[e-1].get("stackedXCoords"),v=s[e-1].get("stackedYCoords"),f=v.length):f=a.length;for(;o<f;o+=1)if(n.isNumber(a[o])){if(e>0){c=v[o];if(!n.isNumber(c)){h=e;while(h>-1&&!n.isNumber(c))h-=1,h>-1?c=s[h].get("stackedYCoords")[o]:c=this._bottomOrigin}a[o]=c-(i-a[o])}p[o]=a[o]}else m.push(o);this._cleanYNaN(u,p),f=m.length;if(f>0)for(o=0;o<f;o+=1)g=m[o],l=e>0?v[g]:i,p[g]=Math.min(p[g],l);this.set("stackedXCoords",u),this.set("stackedYCoords",p)},_cleanXNaN:function(e,t){var r,i,s,o,u,a,f,l,c=n.isNumber,h,p=0,d=t.length;for(;p<d;++p)u=e[p],a=t[p],!c(u)&&p>0&&p<d-1&&(o=t[p-1],s=this._getPreviousValidCoordValue(e,p),l=t[p+1],f=this._getNextValidCoordValue(e,p),c(s)&&c(f)&&(h=(l-o)/(f-s),e[p]=(a+h*s-o)/h),r=NaN,i=NaN)},_getPreviousValidCoordValue:function(e,t){var r,i=n.isNumber,s=-1;while(!i(r)&&t>s)t-=1,r=e[t];return r},_getNextValidCoordValue:function(e,t){var r,i=n.isNumber,s=e.length;while(!i(r)&&t<s)t+=1,r=e[t];return r},_cleanYNaN:function(e,t){var r,i,s,o,u,a,f,l,c=n.isNumber,h,p=0,d=e.length;for(;p<d;++p)u=e[p],a=t[p],!c(a)&&p>0&&p<d-1&&(s=e[p-1],o=this._getPreviousValidCoordValue(t,p),f=e[p+1],l=this._getNextValidCoordValue(t,p),c(o)&&c(l)&&(h=(l-o)/(f-s),t[p]=o+(h*u-h*s)),r=NaN,i=NaN)}},e.StackingUtil=r},"3.9.0pr1",{requires:["series-base","axis-stacked"]});
